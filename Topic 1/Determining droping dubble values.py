import pandas as pd



# Provided list of serial numbers as a string
serials_text = """SN-E2BFF5-VY
SN-F9E6A0-J7
SN-E2BFF5-VY
SN-74A1A4-J7
SN-C591D4-V7
SN-C591D4-V7
SN-881B13-97
SN-E58D19-J7
SN-E3ED12-J7
SN-CE32FF-27
SN-5CF875-9Y
SN-F2E0FD-3Y
SN-08482C-V7
SN-161558-E7
SN-0A0D71-WY
SN-4CC736-9Y
SN-996EEB-X7
SN-C591D4-V7
SN-8A353A-V7
SN-CE391D-9Y
SN-774459-LY
SN-D3AC9B-27
SN-D3AC9B-27
SN-2F7622-WY
SN-2F7622-WY
SN-C164A0-2Y
SN-C164A0-2Y
SN-ACB532-KY
SN-B6717C-2Y
SN-CAAE4A-37
SN-D3AC9B-27
SN-CAAE4A-37
SN-CAAE4A-37
SN-89F326-9Y
SN-C89D6C-3Y
SN-B5F629-3Y
SN-C89D6C-3Y
SN-C89D6C-3Y
SN-5CB1CE-LY
SN-D6CD8A-XY
SN-18D5D7-27
SN-18D5D7-27
SN-18D5D7-27
SN-18D5D7-27
SN-8E65E5-LY
SN-2A936F-KY
SN-ED1250-17
SN-B5BCF0-87
SN-F19C29-KY
SN-90F9C7-KY
SN-F318E3-02
SN-389CA8-01
SN-9391B0-87
SN-9BC9F0-1Y
SN-42A104-1Y
SN-BC1E02-J7
SN-667E82-27
SN-3B86B0-1Y
SN-63B76A-WY
SN-F613C4-KY
SN-7862F5-37
SN-32B9D3-J7
SN-F3A339-XY
SN-D2B5D4-KY
SN-2A87C6-XY
SN-5462E5-V7
SN-849689-27
SN-38649B-VY
SN-2EB821-V7
SN-690B25-WY
SN-DBA9F3-E7
SN-72A4C8-KY
SN-CE2C21-9Y
SN-E3EFB3-V7
SN-E34377-1Y
SN-EDD006-E7
SN-DC28E2-VY
SN-2FC46D-9Y
SN-F75AE6-E7
SN-CC20E3-J7
SN-7DC93C-J7
SN-C164A0-2Y
SN-271E2D-WY
SN-E2BFF5-VY
SN-A6B07E-JY
SN-2F7622-WY
SN-1E9D5E-VY
SN-7BB90E-X7
SN-18D5D7-27
SN-FF3C2F-X7
SN-A54B28-27
SN-01293A-9Y
SN-DA60F0-X7
SN-E7D0F0-27
SN-A65414-VY
SN-1B3B92-E7
SN-479D11-WY
SN-0B23BE-27
SN-28C47B-V7
SN-F0B46E-37
SN-5BA5A0-V7
SN-682A6C-XY
SN-897511-VY
SN-897511-VY
SN-8C30AA-27
SN-9E2D12-9Y
SN-68FEAB-9Y
SN-97314D-3Y
SN-F11799-XY
SN-97B408-27
SN-97B408-27
SN-97B408-27
SN-897511-VY
SN-897511-VY
SN-37FBEB-27
SN-37FBEB-27
SN-37FBEB-27
SN-BE4D5F-X7
SN-BE4D5F-X7
SN-7BB90E-X7
SN-C249B4-VY
SN-996518-87
SN-9532AA-27
SN-71BE89-XY
SN-897511-VY
SN-A4AD72-37
SN-69605E-X7
SN-DC02D0-LY
SN-B092DA-9Y
SN-AA33E1-JY
SN-C0FB68-27
SN-587903-E7
SN-BE4D5F-X7
SN-42A104-1Y
SN-42A104-1Y
SN-4CC736-9Y
SN-4CC736-9Y
SN-7DC93C-J7
SN-E58D19-J7
SN-161558-E7
SN-6E9313-30
SN-E58D19-J7
SN-42A104-1Y
SN-42A104-1Y
SN-161558-E7
SN-E2BFF5-VY
SN-7DC93C-J7
SN-E2BFF5-VY
SN-B5BCF0-87
SN-D3AC9B-27
SN-D3AC9B-27
SN-9391B0-87
SN-F318E3-02
SN-F318E3-02
SN-DC02D0-LY
SN-5BA5A0-V7
SN-5BA5A0-V7
SN-389CA8-01
SN-389CA8-01
SN-249D7F-3Y
SN-C0FB68-27
SN-C0FB68-27
SN-DC02D0-LY
SN-69605E-X7
SN-69605E-X7
SN-97B408-27
SN-97B408-27
SN-9391B0-87
SN-DBA9F3-E7
SN-DBA9F3-E7
SN-D6CD8A-XY
SN-D6CD8A-XY
SN-97314D-3Y
SN-97314D-3Y
SN-9E2D12-9Y
SN-9E2D12-9Y
SN-2A936F-KY
SN-2A936F-KY
SN-B5BCF0-87
SN-389CA8-01
SN-9E2D12-9Y
SN-9E2D12-9Y
SN-E58D19-J7
SN-E58D19-J7
SN-B5BCF0-87
SN-B5BCF0-87
SN-2A936F-KY
SN-2A936F-KY
SN-97314D-3Y
SN-97314D-3Y
SN-D6CD8A-XY
SN-D6CD8A-XY
SN-DBA9F3-E7
SN-DBA9F3-E7
SN-97B408-27
SN-69605E-X7
SN-69605E-X7
SN-C0FB68-27
SN-C0FB68-27
SN-DC02D0-LY
SN-DC02D0-LY
SN-97B408-27
SN-389CA8-01
SN-D6CD8A-XY
SN-D6CD8A-XY
SN-E2BFF5-VY
SN-E2BFF5-VY
SN-4CC736-9Y
SN-161558-E7
SN-161558-E7
SN-42A104-1Y
SN-42A104-1Y
SN-6E9313-30
SN-6E9313-30
SN-D3AC9B-27
SN-D3AC9B-27
SN-6E9313-30
SN-6E9313-30
SN-E58D19-J7
SN-E58D19-J7
SN-4CC736-9Y
SN-4CC736-9Y
SN-4CC736-9Y
SN-6E9313-30
SN-7DC93C-J7
SN-7DC93C-J7
SN-6E9313-30
SN-D3AC9B-27
SN-4CC736-9Y
SN-4CC736-9Y
SN-D3AC9B-27
SN-7DC93C-J7
SN-7DC93C-J7
SN-6E9313-30
SN-6E9313-30
SN-E2BFF5-VY
SN-E2BFF5-VY
SN-97B408-27
SN-97B408-27
SN-69605E-X7
SN-389CA8-01
SN-389CA8-01
SN-69605E-X7
SN-C0FB68-27
SN-9E2D12-9Y
SN-C0FB68-27
SN-9E2D12-9Y
SN-B5BCF0-87
SN-B5BCF0-87
SN-2A936F-KY
SN-2A936F-KY
SN-DC02D0-LY
SN-97314D-3Y
SN-42A104-1Y
SN-97314D-3Y
SN-42A104-1Y
SN-161558-E7
SN-161558-E7
SN-DC02D0-LY
SN-DC02D0-LY
SN-69605E-X7
SN-4CC736-9Y
SN-9E2D12-9Y
SN-B5BCF0-87
SN-B5BCF0-87
SN-7DC93C-J7
SN-C0FB68-27
SN-97314D-3Y
SN-C0FB68-27
SN-97B408-27
SN-97B408-27
SN-97314D-3Y
SN-2A936F-KY
SN-2A936F-KY
SN-9E2D12-9Y
SN-42A104-1Y
SN-69605E-X7
SN-4CC736-9Y
SN-DC02D0-LY
SN-7DC93C-J7
SN-42A104-1Y
SN-42A104-1Y
SN-E2BFF5-VY
SN-E2BFF5-VY
SN-D3AC9B-27
SN-D3AC9B-27
SN-D3AC9B-27
SN-D3AC9B-27
SN-42A104-1Y"""

# Split and strip, then get unique values
serials_list = [s.strip() for s in serials_text.splitlines() if s.strip()]
unique_serials = sorted(set(serials_list))

# Step 2: Load the genealogy dataset
df = pd.read_csv("Dataset4-genealogy.csv")  # Ensure this CSV is in your working directory

# Confirm column names
parent_col = "ParentSerialNumber"
child_col = "ChildSerialNumber"

# Step 3: Count how many serials are parents and how many are children
serial_set = set(unique_serials)
parent_count = df[parent_col].isin(serial_set).sum()
child_count = df[child_col].isin(serial_set).sum()

# Step 4: Output results
print(f"Total unique serials in your list: {len(unique_serials)}")
print(f"Number of serials that appear as parents: {parent_count}")
print(f"Number of serials that appear as children: {child_count}")

